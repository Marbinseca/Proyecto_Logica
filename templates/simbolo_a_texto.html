{% extends "base.html" %}

{% block title %}Símbolos → Texto | Proyecto Lógica{% endblock %}

{% block head %}
  <meta name="description" content="Convierte fórmulas en símbolos lógicos a oraciones en español.">
  <style>
    .symbol-container { margin-top: .75rem; display:flex; gap:.4rem; flex-wrap:wrap; justify-content:center; }
    .symbol-button { min-width: 44px; }
    .result-box { min-height: 48px; }
  </style>
{% endblock %}

{% block background_image %}url('https://source.unsplash.com/random/1920x1080?education,logic'){% endblock %}

{% block content %}
<div class="container text-center">
  <div class="card p-4 mx-auto" style="max-width:800px;">
    <h1 class="mb-3">Convertir símbolos a oración (español)</h1>
    <p class="lead">Ingresa la fórmula con símbolos (ej. P ∨ Q, ¬P, (P → Q)). Puedes añadir una leyenda opcional para asignar cada variable a una oración en español (formato: P: Juan come...)</p>

    <form method="post" class="mb-3" novalidate>
      <!-- CSRF token necesario -->
      <input type="hidden" name="csrf_token" value="{{ csrf_token }}">

      <div class="mb-3 text-start">
        <label for="formula-input" class="form-label">Fórmula (símbolos)</label>
        <input id="formula-input" name="formula" class="form-control" placeholder="Ej: P ∨ Q" data-default-target="true" value="{{ request.form.formula if request.method=='POST' else '' }}">
      </div>

      <div class="mb-3 text-start">
        <label for="legend" class="form-label">Leyenda (opcional) — una por línea, formato <code>P: frase</code></label>
        <textarea id="legend" name="legend" class="form-control" rows="4" placeholder="P: Juan come en el restaurante&#10;Q: María viste una camisa roja">{{ request.form.legend if request.method=='POST' else '' }}</textarea>
      </div>

      <div class="symbol-container" aria-hidden="false">
        <button type="button" class="symbol-button btn btn-light" data-symbol="¬" title="Negación">¬</button>
        <button type="button" class="symbol-button btn btn-light" data-symbol="∧" title="Conjunción">∧</button>
        <button type="button" class="symbol-button btn btn-light" data-symbol="∨" title="Disyunción">∨</button>
        <button type="button" class="symbol-button btn btn-light" data-symbol="→" title="Condicional">→</button>
        <button type="button" class="symbol-button btn btn-light" data-symbol="↔" title="Bicondicional">↔</button>
        <button type="button" class="symbol-button btn btn-light" data-symbol="(" title="Abrir paréntesis">(</button>
        <button type="button" class="symbol-button btn btn-light" data-symbol=")" title="Cerrar paréntesis">)</button>
        <button type="button" class="symbol-button btn btn-light" data-symbol=" " title="Espacio">␣</button>
      </div>

      <div class="d-flex gap-2 justify-content-center mt-3">
        <button type="submit" class="btn btn-primary">Convertir</button>
        <button type="button" class="btn btn-outline-secondary" id="limpiar-btn">Limpiar</button>
      </div>
    </form>

    {% if resultado %}
      <div class="mt-4 text-start">
        <h3>Oración generada</h3>
        <div class="border p-3 result-box">{{ resultado }}</div>
      </div>
    {% endif %}

    {% if leyenda %}
      <div class="mt-3 text-start">
        <h5>Leyenda usada:</h5>
        <ul>
        {% for k, v in leyenda.items() %}
          <li><strong>{{ k }}:</strong> {{ v }}</li>
        {% endfor %}
        </ul>
      </div>
    {% endif %}

    {% if error %}
      <div class="alert alert-danger mt-3">{{ error }}</div>
    {% endif %}
  </div>
</div>

<script src="{{ url_for('static', filename='js/symbol_inserter.js') }}"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const limpiar = document.getElementById('limpiar-btn');
  const formula = document.getElementById('formula-input');
  const legend = document.getElementById('legend');
  if (limpiar) {
    limpiar.addEventListener('click', function () {
      if (formula) formula.value = '';
      if (legend) legend.value = '';
      if (formula) formula.focus();
    });
  }
});
</script>
{% endblock %}